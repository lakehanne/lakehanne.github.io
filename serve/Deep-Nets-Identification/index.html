<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title><center>Nonlinear Identification with Deep Neural Networks</center></title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="To Discover and Understand.">
    <link rel="canonical" href="lakehanne.github.ioDeep-Nets-Identification">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/main.css">

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-3698471-23', 'auto');
      ga('send', 'pageview');
    </script>

</head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <div style="float:left; margin-top:10px; margin-right:10px;">
    <a href="/feed.xml">
      <img src="/downloads/rssicon.svg" width="40">
    </a>
    </div>

    <a class="site-title" href="/">Olalekan Ogunmolu</a>
    
    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        
          
        
          <a class="page-link" href="/about/">About</a>
        
          
        
          
        
          <a class="page-link" href="/lakehanne.github.io/about/">About</a>
        
          
        
      </div>
    </nav>
  </div>

</header>


    <div class="page-content">
      <div class="wrap">

      <div class="post">

  <header class="post-header">
    <h1><center>Nonlinear Identification with Deep Neural Networks</center></h1>
    <p class="meta">Sep 30, 2016</p>
  </header>

  <article class="post-content">
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

<!--Mathjax Parser -->

<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>

<p><center>&quot;All the world is a Nonlinear System <br>
          He Linearized to the Right <br>
          He Linearized to the Left <br>
          Till Nothing was Right <br>
          And Nothing was Left.&quot;<br>
          -- Stephen Billings</center> </p>

<p><a href="#table-of-contents">Table of Contents</a></p>

<ul>
<li><p><a href="#introduction">Introduction</a></p></li>
<li><p><a href="#what-are-dynamic-neural-networks?">Deep Neural Networks</a></p></li>
</ul>

<h3>Introduction</h3>

<TABLE BORDER="4"    WIDTH="85%"   CELLPADDING="1" CELLSPACING="2" ALIGN="CENTER">

    <TR ALIGN="CENTER">
      <TH>Abbreviation</TH>
      <TH>Meaning</TH>
      <TH>Abbreviation</TH>
      <TH>Meaning</TH>
    </TR>

    <TR ALIGN="CENTER">
      <TD>POMDP</TD>
      <TD>Partially Observable Markov Decision Process</TD>  
      <TD>DNN</TD>
      <TD>Deep Neural Network</TD>   
    </TR>

    <TR ALIGN="CENTER"> 
      <TD>SISO</TD>
      <TD>Single Input Single Output</TD>   
      <TD>MIMO</TD>
      <TD>Multi Iinput Multi Output</TD>  
    </TR>   

    <TR ALIGN="CENTER">
      <TD>RT</TD>
      <TD>Radiotherapy</TD> 
      <TD>MLP</TD>
      <TD>Multilayer Network (MLP)</TD>     
    </TR>  

    <TR ALIGN="CENTER">
      <TD>RNN</TD>
      <TD>Recurrent Neural Network</TD>  
      <TD>LSTM</TD>
      <TD>Long Short-Term Memory</TD>  
    </TR>  

    <TR ALIGN="CENTER">
      <TD>GRU</TD>
      <TD>Gated Recurrent Unit</TD>   
      <TD>MSE</TD>
      <TD>Mean Square Error</TD>
    </TR>  

    <TR ALIGN="CENTER">
      <TD>FPE</TD>
      <TD>Akaike's Final Prediction Error</TD>    
      <TD>AIC</TD>
      <TD>Akaike Information Criterion</TD>
    </TR>    
</TABLE>

<p>(Artificial) Neural Networks applications are the latest rage in town. In the past four years alone, neural networks have been used more than ever before in approximating complex real-world nonlinear phenomena. If you use email that automatically disables spam, if you use a voice recognition software to navigate around your city, or if you use google translator to snoop on other people&#39;s conversations when in a foreign country, chances are high that you have used an application that is implementing a neural network in the backend. When NNs are combined in multiple layers, with each layer representing a level of abstraction, they are called deep neural networks. Deep networks allow compositional models made up of several simple processing layers with each layer transforming a complex representation at a higher, more absstract level to lower-level features. Broad applications of DNNs range from <a href="https://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf">image classification</a>, <a href="http://ieeexplore.ieee.org/document/6638947/?arnumber=6638947">speech processing</a>, <a href="http://arxiv.org/abs/1410.4615">language models</a> to <a href="http://axon.cs.byu.edu/%7Emartinez/classes/678/Papers/Convolution_nets.pdf">handwriting classification</a>. They are increasingly finding applications to control problems. For example, <a href="https://deepmind.com/research/alphago/">AlphaGo</a> beat world-record players in the difficult game of GO earlier this year. Even so in Atari games, they have proven to be able to achieve human-level control e.g. based on raw pixel values, or using raw sensory inputs to achieve advanced manipulation skills. </p>

<blockquote>
<p>Deep networks allow compositional models made up of several simple processing layers that each transform a complex representation at a higher, more absstract level to lower-level features.</p>
</blockquote>

<p>The probing inquirer might ask, what makes (D)NNs so efficient at tasks that are otherwise difficult to solve in closed-form anyway? Well for one reason, (D)NNs in their most basic forms are an artificial representation of the pulse-frequencies found in neurons in the brain. They are the closest approximation to the giant supercomputer we humans have in our head (the human brain is estimated to have billions of neural circuit connections with back-coupled neurons and feedforward connections working together to help us understand our world). Imagine trying to mathematically formulate the factors of variation that dynamically capture how swarms of birds fly in different formations so that we can predict formation based on abstract formulae for different conditions (such as wind speed, humidity, light intensity et cetera) that affect flying behavior? It is a task that is difficult to manually formalize. Many problems in control have stochastic, high-dimensional dynamics that are highly nonlinear, usually POMDP ( in continuous processes). Analytical solutions that may be found may be too complicated to abstract into closed-form equations, building dynamical models that generalize to new contexts may be difficult, and the complexity of solving such high-dimensional spaced tasks may be intractable. Many researchers have thus resolved to devising learning algorithms that can <i>learn</i> these complex patterns in nature by building neural network structures that learn high-dimensional nonlinear phenomena. When implemented in the various structural combinations for pattern recognition or identification problems as discussed in this paper, disregarding the time chartacteristics, (D)NN output units are similar to gnostic cells in the brain.</p>

<h3>What are Dynamic Neural Networks?</h3>

<p><b><u>Static neural networks</u></b> are characterized by compact sets \(\mathbb{U}_i \subset \mathbb{R}^n \) being mapped into elements \(y_i \in \mathbb{R}^m \, \forall \, \,  (i = 1,2, \cdots, n) \) in the space of the output by a decision function \(\mathbb{F}\) (the elements of \(\mathbb{U}_i\)would be the input elements mapped to class \(y_i\) ). Static neural networks are used in pattern recognition problems. For a <b><u>dynamical system</u></b>, the operator $\mathbb{F}$ defines a plant based on an input-output pair of functions \({u(k), y(k)} \, \, \forall \, \, k \in [0, T]\). In either case, the objective is the same: finding the operator \(\hat{\mathbb{F}}\) that approximates the actual operator \(\mathbb{F}\) to a sufficient degree \(\epsilon &gt; 0\), \(i.e.\ \),
\begin{align}
  \lVert \hat{y} - y \lVert = \lVert \hat{\mathbb{F}}(u) - \mathbb{F}(u) \lVert \le \epsilon, \qquad u \in \mathbb{U}
\end{align}</p>

<p>where \(\lVert \cdot \lVert \) is an appropriately-chosen norm on the output space and \(\epsilon \) is a sufficiently positive number.</p>

<p>For low-dimensional systems, finite linear combinations of the input space and a set of affine functions can uniformly approximate continuous functions of \(n\) real variables with support in the unit hypercube. Cybenko <a href="https://www.dartmouth.edu/%7Egvc/Cybenko_MCSS.pdf">developed theorems</a> that showed networks with one internal layer and an arbitrary continuous sigmoidal function can approximate continuous functions with arbitrary precision, provided that there are no restraints placed on the number of nodes or the size of the network weights. In other words, a single hidden layer is sufficient as a universal function approximator with the ability to approximate any Borel measurable function from one finite dimensional space to another. In terms of representability by hidden layers in multilayer networks, it is a settled question that arbitrary decision regions are well <i><b>approximated</b></i> by continuous deep networks with continuous nonlinearity<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. The focus of deep networks is on approximated solutions and not exact solutions as Mathematicians would love to think.</p>

<blockquote>
<p>It is a settled question that arbitrary decision regions in nonlinear systems are well <i><b>approximated</b></i> by continuous deep networks with continuous nonlinearity.</p>
</blockquote>

<p>When the dimension of the dataset increases, finding a learning algorithm that scales to the learning problem irrespective of translation and geometric irregularities in data, and identifies the underlying structure in spite of noise in the data becomes more complicated. Enter deep learning. Representing the complicated structure of high-dimensional data is what deep nets are good at doing mostly because (i) the presence of local minima in the loss function is not a hindrance to learning for gradient-based algorithms that deep learning algorithms use (e.g. Boltzman machines successfuly learn nonlinear phenomena), and (ii) backpropagation for gradient computation in multi-layered networks with continuous, differentiable, and bounded activation functions can learn nonlinear phenomena well <a href="#fn2" class="footnoteRef" id="fnref2"><sup>1</sup></a>.</p>

<p>This blog post serves as an addendum to the paper I submitted to <i>American Control Conference (ACC) </i> last week titled <b><i><a href="http://bibbase.org/service/mendeley/ac6ea3d6-def2-3e3f-b8fd-4db9697c94d6/file/3570398e-42e5-bf5b-64cd-cee1cd135a15/2017-Nonlinear_Systems_Identification_Using_Deep_Dynamic_Neural_Networks.pdf.pdf">Nonlinear Systems Identification Using Deep Dynamic Neural Networks</a></i></b>. Here I briefly go over the model structures I used, describe the datasets and expand a little more on the training procedure on the <i>Database for System Identification</i> data that I used. The codes are indexed on <a href="https://github.com/lakehanne/FARNN">github</a> and if you do not care about the theory behind my choices in training the respective networks I described in the paper, you are welcome to start trainng your network.</p>

<h3>Datasets and preliminaries</h3>

<p>Radiation therapy are by far the best procedure for the treatment of distributed cancer cells. They are effective at shrinking cancer tumor cells using high-precision localization of dosage targets to knock off tumor cells in the human body. Typically, the patient is treated with image-guided radiation therapy whereby a stereoscopic camera observes the patient while they are being treated with electron beams on a 6-DoF couch. The couch is adjusted by a radiation therapist during treatment to correct for involuntary motions and deviation of the patient&#39;s position from planned target(s). The cancer RT treatment is often stopped during treatment to correct for motion deviations using the 6-DoF robot. But the robots used are highly rigid systems that produce just enough torques for motion correction but not enough articulation to account for the non-rigidity of the curvatures of the human body. In a recent work, we tested the ability of inflatable air bladders (IABs) to compensate for the inadequate actuations provided in motion alignment correction systems (e.g. 6-DoF robot couches) used in maskless head and neck cancer radiotherapy. The soft-robot&#39;s precision was evaluated in the motion alignment and correction of these 6-DoF robots in a simulated cancer RT scenario.  We had a mannequin head lying in a supine position on a table that simulated our proposed motion alignment correction set-up during cancer RT. A soft-robot actuator in the form of an inflatable air bladder (IAB) moved the mannequin head based on supplied air pressure. This corrected for non-rigid motions during treatment. The IAB was actuated by current-driven proportional pneumatic valves; the experimental set-up is described in this <a href="http://arxiv.org/abs/1506.04787">CASE2015 Paper</a>, but the change in head motion is now recorded by a more accurate motion capture (mocap) system instead of an RGB-D camera system. The mocap system is capable of measuring head position with less than 1 \(mm \) error. This is a SISO system with input as current (generated from pseudo-random binary sequences) in \(mm \) and outputs as head height in \(mm \). We collected \(10,070\) samples of input-output data offline, and in all experiments, we separate the dataset in a \( 60:40\% \) ratio for training and testing purposes. </p>

<div class="fig figcenter fighighlight"> 
<img src="/imgs/NNDyn/setup.png" align="center" height="500px" />
<div class="figcaption" align="middle">Fig. 1: Experimental Set-up for soft robot system.</div>
</div>

<p>The main idea in system identification is to charcterize the behavior of a plant by an operator \( \mathbb{F} \) that resolves the dynamics of a plant based on input-output datapair \( {u_i(k), y_i(k)} \)  for all \(i = 1, 2, \cdots , N \). Previously, an LTI model generated from a <i>prediction error model</i> was used in characterizing the system. This was insufficient to approximate the system nonlinearity. So here we propose NN-based Hammerstein block-structured models (Fig. 2).</p>

<div class="fig figcenter fighighlight"> 
<center><img src="/imgs/NNDyn/ham.png"/></center>
<div class="figcaption" align="center">Fig 2: The Hammerstein block-structured model.</div>
</div>

<p>In the Hammerstein model above, there are two block structures: one is a nonlinear element (the \(g(\cdot)\) block that models the dynamics from inputs to states while the second structure approximates the linear dynamics from states to the output space. I used deep recurrent network modules to model the nonlinear element while a linear multiulayer network models the \(G(z^{-1}) \) block.   </p>

<h4>Multilayer Networks</h4>

<p>These are the <a href="https://www.researchgate.net/profile/Terrence_Sejnowski/publication/242509302_Learning_and_relearning_in_Boltzmann_machines/links/54a4b00f0cf256bf8bb327cc.pdf">Rumelhart et al&#39;s</a> feedforward networks with forward connections only signals between adjoining units. The networks are composed of layers of input and output signals with one or more hidden layers embedded between them. A differentiable, continuous and bounded monotonically increasing function (such as the sigmoid function) is used as the output of each network node (or unit). The relationship between the input and output datapair is usually learned by the backpropagation algorithm (while this is not the only means of training a network, it seems to me by far the most efficient and popular method) . This algorithm uses gradient descent to modify the parameters and thresholds of the network to the end of minimizing the error between the predicted output and actual output of the network. For a detailed treatment of how the backpropagation algorithm works, I recommend <a href="https://mattmazur.com/2015/03/17/a-step-by-step-backpropagation-example/">Matt Mazur&#39;s backpropagation example blog post</a>. Multilayer networks have signal that flow in one direction only (possibly why they are often referred to as feedforward networks in literature). Introduced by Rumelhart-Williams-Hinton in the eighties, joining the weights and biases of the network completely parameterizes the system they are trained on. </p>

<div class="fig figcenter fighighlight"> 
<center><img src="/imgs/NNDyn/mlp.png" padding-right="20cm"/></center>
<div class="figcaption" align="middle">Fig 3: A simple multilayer network with 2 inputs, 3 nodes in <br>the hidden layer and 2 outputs.</div>
</div>

<h4>Recurrent Networks</h4>

<p>We can think of these as feedforward networks with tapped delay lines. Inspired by the behavior of cells in nature with asynchronous parallel processing i.e. content-addressable memory with phase-space flow of the state of a system <a href="#fn3" class="footnoteRef" id="fnref3"><sup>1</sup></a>., they have the ability to capture long-term information based on pieces of the information that is available to them. In complex systems composed of several subsystems that interact to yield collective intelligence, the nature of the collective properties is insensitive to the individual behavior of specific sub-elements. These are what RNNs are good at (non-Markovian control). For an expository introduction to Recurrent Neural Networks, I recommend going through Andrej Karpathy&#39;s illuminating blog post on the <a href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/">unreasonable effectiveness of recurrent networks</a>. </p>

<p>RNNs are the meat of this work and I dwell a little on their mathematical structure here. Assume the following text that is stored in memory, <i>&quot;Funahashi, K. I. (1989). On the approximate realization of continuous mappings by neural networks.&quot;</i> A content addressable memory should be able to retrieve the entire memory given enough partial information such as &quot;Funahashi, 1989&quot;. It should deal with errors by obtaining this reference through a self-correcting process. Now suppose the text in memory is stochastic in nature such that the equations that describe the content being written to memory is a flow in state space making the model more difficult to describe. Therefore stability becomes relative. But if minimal changes are being made in the letters written into memory, the stochastic effects are small so that the core of local stable points in the phase space remain. To bring the point home, a system whose physical dynamics in phase space is dominated by a substantial amount of locally stable nodes to which it is attracted is in general a content-addressable memory.</p>

<div class="fig figcenter fighighlight"> 
<center><img src="/imgs/NNDyn/rnn.png" width="400px" height="300px"/></center>
<div class="figcaption" align="middle">Fig 4: A simple recurrent neural network.</div>
</div>

<blockquote>
<p>a system whose physical dynamics in phase space is dominated by a substantial amount of locally stable nodes to which it is attarcted is generally referred to as content-addressable memory.</p>
</blockquote>

<p>From Fig. 5, there is a striking disimilarily to the multilayer network depicted ini Fig. 4: that is the self-feedback of neurons in the hidden layer. Through this recurrent nature, neurons in the hidden layer are able to randomly and asynchronously determine if they should fire or not, based on their thresholds. The strong back-coupling of RNNs alllow for modeling delays in discrete-time dynamical systems and asynchronously process information. With a single hidden-layer, for example, such a network can be described by </p>

<p>\begin{align}
x(k+1) = f(x(k)), \qquad x(0) = x_o
\end{align}</p>

<p>where \(f(\cdot) \) is a suitably chosen nonlinear, bounded continuous function. If the system under consideration is a continuous-time system, the dynamical system in the feedback path has a diagonal transfer matrix with elements \(1/(s + \alpha) \) along the diagonal <a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a>. \(\alpha \) is an unknown parameter that parameterizes the lagged outputs; the system is then represented by the equation</p>

<p>\begin{align}
\dot{x} = -\alpha x + f(x) + U
\end{align}</p>

<p>where \( x(t) \in \mathbb{R}^n \) is the system&#39;s state at time t, and the constant vector \(U \in \mathbb{R}^n \) is the input. The gradients&#39; computation in a RNN are commonly computed through <a href="http://www.cs.cmu.edu/%7Ebhiksha/courses/deeplearning/Fall.2013/pdfs/Werbos.backprop.pdf">backpropagation thorugh time (BPTT)</a>, using Real-Time Recurrent Learning (Robinson and Fallside 1987), or other sensitivity analysis methods (Billings, S.A.). </p>

<h5>Long Short-Term Memory</h5>

<p>While ordinary recurrent networks are good for finite-delays, when the sequence of recurrence goes back in time by a significant order (e.g.  \(&gt; 500\)), the gradients can become intractable. For example, consider a network node whose output unit \(k\) at time \(t\) is \(y_k(t)\) so that the error computed for node \(k\) is </p>

<p>\begin{align}
  \epsilon_k(t) = {\sigma&#39;_k} \, [net_k(t))(\hat{y}^k(t) - y_k(t)]
\end{align}</p>

<p>where 
\begin{align}
  net_i(t) = \sum\limits_{j}^{}w_{ij} \, y^j (t -1)
\end{align}</p>

<p>and
\begin{align}
  y^i(t) = \sigma_i \, [net_i(t)]
\end{align}</p>

<p>is the activation of an non-input node \(i\) with activation function \(\sigma_i\). The error signal of a non-output unit \(j\) that is backpropagated is (see Horchreiter&#39;s analysis, 1997),</p>

<p>\begin{align}
  e_j(t) = \sigma&#39;_j[net_j(t)] \sum\limits_{i}^{}w_{ij} \, e_i (t+1)
\end{align}</p>

<p>so that the contribution to \(w_{ji}\)&#39;s weight update is \(\alpha e_j(t)y^l(t-1)\), where \(\alpha\) is the step size for the gradient descent function on a neuron in layer \(l\), that is connected to neuron \(j\). Now if the indices of a fully connected neuron range from \(1 \text{ to } n\), then the local error flow from a neuron unit \(u\) to \(v\) that is backpropagated in time for \(q\) time steps to a unit \(v\) is scaled as follows</p>

<p>\begin{align}
  \dfrac{\partial e_v(t-q)}{\partial e_u(t)} &amp;= \sigma&#39;_v[net_v(t-1)]w_{uv} \qquad \text{ if } q = 1 \text{ or } 
\end{align}</p>

<p>\begin{align}    \label{eq:bptterr}
  \dfrac{\partial e_v(t-q)}{\partial e_u(t)} &amp;= \sigma&#39;_v[net_v(t-q)] \sum\limits_{l = 1}^{n} \dfrac{\partial e_l(t-q+1)}{\partial e_u(t)} w_{lv} \qquad \text{ if } q &gt; 1
\end{align}</p>

<p>If \(l_q = v \text{ and } l_0 = u \) is follows that</p>

<p>\begin{align}      \label{eq:errorback}
    \dfrac{\partial e_v(t-q)}{\partial e_u(t)} = \sum\limits_{l_1 = 1}^{n} \cdots \sum\limits_{l_{q-1} = 1}^{m} \, \prod\limits_{m=1}^{q} \sigma&#39;_{lm}[net_{lm}(t -m)] w_{l_m} l_{m-1}
\end{align}</p>

<p>so that if \(|\sigma&#39;_{lm}[net_{lm}(t -m)] w_{l_m} l_{m-1}| &gt; 1.0 \text{ for all} m\), then the product term in \eqref{eq:errorback} is intractable (causing the errors that flow back in time from u to v to be too large). Similarly, if \(|\sigma&#39;_{lm}[net_{lm}(t -m)] w_{l_m} l_{m-1}| &lt; 1.0 \text{ for all } m\), then the product term exponentially decreases with the degree of \(q\) so thatthe error vanishes before reaching \(u\). These two conditions make learning difficult within a reasonable time-frame because (i) the error signals that are backpropagated in time can become infinitely high so that the gradients explode causing oscillating weights in the network or (ii) the errors being temporally backpropagated  could be so small that they cause gradients to vanish so that it becomes a lot more complex to compute gradients with slowly-varying network parameters.</p>

<p>Because of these issues with remembering long-term contextualization of inputs, RNNs have undergone different transformations in their basic architecture since the first <a href="https://en.wikipedia.org/wiki/Hopfield_network">Hopfield Net</a>. Recent works have sought to improve the vanishing and exploding gradients problem. Of important use to this work are Horchreiter&#39;s <a href="http://deeplearning.cs.cmu.edu/pdfs/Hochreiter97_lstm.pdf">Long Short Term Memory</a> and Cho&#39;s <a href="http://arxiv.org/abs/1406.1078">Gated Recurrent Units</a> (LSTM). The LSTM network protects error flow from stochastic perturbations by employing <i>multiplicative units</i> that enforces constant error flows and solves long time-lag issues. For a weight matrix \(W\), the LSTM takes \(O(W)\) operations <a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a>.</p>

<h5>Gated Recurrent Units</h5>

<p>Like LSTMs, <b>GRUs</b> were invented to solve the long-term contextualization of delayed signals, albeit with lesser computational complexity compared against LSTMs. The GRU consists of two types of RNN (an encoder and a decoder) acting separately transforming the input sequence into hidden states that are computed in different fashions to maximize the conditional log likelihood </p>

<p>\begin{align}
  \text{max}_{\theta} \dfrac{1}{N} \sum\limits_{n=1}^{N}log p_\theta (y_n | x_n)
\end{align}</p>

<p>where \(n\) is the lenth of the sequence, \(\theta\) is the vector of model parameters, and \(p_\theta\) = \(p(y_1, \cdots, y_n | x_1, \cdots, x_n)\). For an input sequence \(\textbf{x} = (x_1, \cdots, x_n)\), the hidden state of the encoder is generated as a nonlinear function represented like so</p>

<p>\begin{align}
  h_t = f(h_{t-1}, u_t)
\end{align}</p>

<p>such that the RNN can predict the next element in the sequence by learning the probability distribution over the input sequence. The output at each time step is the conditional distribution \(p(x_k = 1| x_1, \cdots, x_n\). For a \(1-of-K\) encoding, the probability output can be computed for the entire sequence using </p>

<p>\begin{align}
p(x) = \prod\limits_{k = 1}^{K}p(x_k|x_{k-1}, \cdots , x_1).
\end{align}</p>

<p>The encoder reads the input sequence and updates the hidden state of the RNN as a summary \(c\) for the whole sequence.</p>

<p>The decoder uses another simple RNN by predicting the next output sequence \(y_k\) given the hidden state, \(h_k\) but \(y_k\) and \(h_k\) are in turn conditioned on \(y_{k-1}\) and the generated summary from the input sequence, \(\textbf{c}\). In other words, </p>

<p>\begin{align}
  h_{k} = f(h_{k-1}, y_{k-1}, \textbf{c})
\end{align}</p>

<p>Again, the conditional distribution of \(y_k\) is given by </p>

<p>\begin{align}
P(y_k | y_{k-1}, \cdots, y_k, \textbf{c}) = g(\textbf{h_k}, y_{k-1}, \textbf{c})
\end{align}</p>

<p>We can imagine the encoder-decoder as jointly maximizing the conditional log-likelihood </p>

<p>\begin{align}
max_\theta \dfrac{1}{N}\sum\limits_{n=1}^{N} log p_\theta(y_n|x_n)
\end{align}</p>

<p>The hidden unit is composed of two critical gates, as is the case for the LSTM, that adaptively forgets or remebers a long-range sequence. The reset gate is given by </p>

<p>\begin{align}
r_j = \sigma\left([\textbf{W}_r\textbf{x}]_j + [\textbf{U}_r \textbf{h}_{k-1}]_j\right)
\end{align}</p>

<p>with \(\sigma\) being the logistic sigmoid function and \([\cdot]_j\) being the \(j-th\) element of the vector. The update gate is computed as</p>

<p>\begin{align}<br>
  z_j = \sigma\left([\textbf{W}\textbf{x}]_j + [\textbf{U}(\textbf{r} \odot \textbf{h}_{t-1} )]_j\right)
\end{align}</p>

<p>The activation of the hidden unit \(h_j\) is determined through</p>

<p>\begin{align}
h_j^(k) = z_j h_j ^ {k -1} + (1 - z_j) \bar{h_j^k}
\end{align}</p>

<p>where</p>

<p>\begin{align}
\bar{h_j^k} = \phi\left([\textbf{Wx}_j + [\textbf{U}(\textbf{r \odot \textbf{h}_{t-1}]_j\right)
\end{align}</p>

<p>Examining </p>

<p>...continued in <a href="https://lakehanne.github.io/Deep-Nets-Identification-2">post 2</a></p>

<h3>Acknowledgement</h3>

<p>I am grateful to the maintainers of the Torch package which has helped in accelerating the training my models.
I am also grateful to <a href="https://twitter.com/hugo_larochelle">Hugo Larochelle</a> and <a href="https://cbmm.mit.edu/about/people/kulkarni">Tejas Kulkarni</a> for pointing me in the direction of best practices for regularizing the layers of a recurrent neural network during training.  </p>

<section class="footnotes">
<hr>
<h4>References</h4> 
<ul>
<li id="fn1"><p> Cybenko, G. (1993). Approximation by Superpositions of a Sigmoidal Function. Approximation Theory and Its Applications, 9(3), 17–28. http://doi.org/10.1007/BF02836480<a href="#fnref1">↩</a></p></li>
</ul>

<ul>
<li id="fn2"><p>
LeCun, Y., Bottou, L., Bengio, Y., & Haffner, P. (1998). Gradient-based learning applied to document recognition. Proceedings of the IEEE, 86(11), 2278–2323. http://doi.org/10.1109/5.726791
<a href="#fnref2">↩</a></p></li>
</ul>

<ul>
<li id="fn3"><p>
Hopfield, J. J. (1982). Neural networks and physical systems with emergent collective computational abilities. Proceedings of the National Academy of Sciences of the United States of America, 79(8), 2554–2558. http://doi.org/10.1073/pnas.79.8.2554
<a href="#fnref3">↩</a></p></li>
</ul>

<ul>
<li id="fn4"><p>
Narendra, K. S. (1992). Identification and Control of Dynamical Systems Using Neural Networks.
<a href="#fnref4">↩</a></p></li>
</ul>

<ul>
<li id="fn5"><p>
Hochreiter, S., & Schmidhuber, J. (1997). Long short-term memory. Neural Computation, 9(8), 1735–80. http://doi.org/10.1162/neco.1997.9.8.1735
<a href="#fnref5">↩</a></p></li>
</ul>

</section>

  </article>

  <!-- mathjax -->
  
  <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
  
  
  <!-- disqus comments -->
 
 <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'patmeansnoble'; // required: replace example with your forum shortname
      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  

</div>

     <!--<nav class="nav-primary" role="navigation" >
    <ul>
        
        <li>
        	 <a class= "post-link" href=""></a>
        </li>
        
        <li>
        	 <a class= "post-link" href=""></a>
        </li>
        
        <li>
        	 <a class= "post-link" href=""></a>
        </li>
        
        <li>
        	 <a class= "post-link" href=""></a>
        </li>
        
        <li>
        	 <a class= "post-link" href=""></a>
        </li>
        
        <li>
        	 <a class= "post-link" href=""></a>
        </li>
        
        <li>
        	 <a class= "post-link" href=""></a>
        </li>
        
        <li>
        	 <a class= "post-link" href=""></a>
        </li>
        
        <li>
        	 <a class= "post-link" href=""></a>
        </li>
        
        <li>
        	 <a class= "post-link" href=""></a>
        </li>
        
        <li>
        	 <a class= "post-link" href=""></a>
        </li>
        
        <li>
        	 <a class= "post-link" href=""></a>
        </li>
        
        <li>
        	 <a class= "post-link" href=""></a>
        </li>
        
    </ul>
</nav>-->
      </div>
    </div>

    <head>

 <!--Font Awesome -->
 <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

  <footer class="site-footer">

  <div class="wrap">

    <!-- <h2 class="footer-heading">Olalekan Ogunmolu</h2> -->

    <div class="footer-col-1 column">
      <ul>
        <li>
          <a class="github-button" href="https://github.com/lakehanne" data-style="mega" data-count-href="/lakehanne/followers" aria-label="Follow @lakehanne on GitHub"></a>
        </li>
      </ul>

        <ul><li>
          <a href="https://twitter.com/patmeansnoble" target="_blank" ><img src = "/downloads/TwitterLogo_blue.png" width="16%", height="17%"></a>
        </li></ul>

    </div>

    <div class="footer-col-2 column">
    
      <ul>        
        
        <li>          
          <a href="https://www.quora.com/Olalekan-Ogunmolu" target="_blank"><img src="/downloads/quora.svg" width="12%", height="5%"></a>
          
        </li>
        
      </ul>

      
      <ul>
        
        <li>
          <!-- <a href="mailto:lexilighty@gmail.com"><i class="fa fa-fw fa-envelope-square"> Email</i></a> -->
          <a href="mailto:lexilighty@gmail.com" class="author-social" target="_blank"><i class="fa fa-fw fa-envelope-o"></i></a>

        </li>
      </ul>
      

    </div>

    <div class="footer-col-3 column">
      <p class="text"><b>To Discover and Understand.</b></p>
    </div>

  </div>
<script async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
</footer>

</head>


    </body>
</html>